<!DOCTYPE html>
<html lang="en">

<head>
  <title>Niobium Studio</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,400,700">
  <link rel="stylesheet" href="fonts/icomoon/style.css">

  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/magnific-popup.css">
  <link rel="stylesheet" href="css/jquery-ui.css">
  <link rel="stylesheet" href="css/owl.carousel.min.css">
  <link rel="stylesheet" href="css/owl.theme.default.min.css">


  <link rel="stylesheet" href="css/aos.css">

  <link rel="stylesheet" href="css/style.css">

</head>

<body>

  <div class="site-wrap">


    <div class="site-navbar bg-white py-2">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between">
          <div class="logo">
            <div class="site-logo">
              <a href="index.html" class="js-logo-clone">Niobium Studio</a>
            </div>
          </div>
        </div>
      </div>
    </div>





    <div class="site-section" style="margin-top: 100px;">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h2 class="h3 mb-3 text-black">Get In Touch</h2>
          </div>
          <div class="col-md-7">

            <form onsubmit="return false;" method="post" id="contactForm">

              <div class="p-3 p-lg-5 border">
                <div class="form-group row">
                  <div class="col-md-12">
                    <label for="realname" class="text-black">Name <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="realname" name="realname">
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-md-12">
                    <label for="email" class="text-black">Email <span class="text-danger">*</span></label>
                    <input type="email" class="form-control" id="email" name="email" placeholder="">
                  </div>
                </div>


                <div class="form-group row">
                  <div class="col-md-12">
                    <label for="message" class="text-black">Message </label>
                    <textarea name="message" id="message" cols="30" rows="7" class="form-control"></textarea>
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-lg-12">
                    <input type="submit" id="submit" class="btn btn-primary btn-lg btn-block" value="Send Message">
                    <div id="sent" class="sent" style="display: none;">Sent</div>
                  </div>
                </div>
              </div>
            </form>
          </div>

        </div>
      </div>
    </div>


    <footer class="site-footer custom-border-top">
      <div class="container">
        <div class="row">
          <div class="col-md-6 col-lg-6 mb-4 mb-lg-0">

            <div class="block-7">
              <h3 class="footer-heading mb-4">About Us</h3>
              <p>We're a New Zealand-based online store offering everyday essentials at great prices — all delivered
                straight to your door. From home goods to daily must-haves, we make shopping simple, local, and
                stress-free. Thanks for supporting a Kiwi-owned business!</p>
            </div>
            <div class="block-7">
              <label for="email_subscribe" class="footer-heading" style="color: #343a40;"><a href="terms.html"
                  style="color: #343a40;">Terms & Conditions</a></label>
            </div>
          </div>


          <div class="col-md-6 col-lg-6">
            <div class="block-5 mb-5">
              <h3 class="footer-heading mb-4">Contact Info</h3>
              <ul class="list-unstyled">
                <li class="address">3/15 Ely Avenue, Remuera, Auckland 1050</li>
                <li class="phone"><a href="tel://0276116666">027 611 6666</a></li>
                <li class="email">sales@niobium.co.nz</li>
                <li class="">NZBN: 9429046529206</li>
              </ul>
            </div>


          </div>
        </div>
        <div class="row pt-5 mt-5 text-center">
          <div class="col-md-12">
            <p>
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              Copyright &copy;
              <script>document.write(new Date().getFullYear());</script> All rights reserved
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
          </div>

        </div>
      </div>
    </footer>
  </div>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/jquery-ui.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>

  <script src="js/main.js"></script>

  <script src="vendor/jquery.validate.min.js"></script>
  <!-- Google tag (gtag.js) -->
  <script src="https://www.google.com/recaptcha/api.js?render=6Lc40QkrAAAAAFrU4QsisFutWvuC9F5sDNpXLLiP"></script>
  <script>
    $(document).ready(function () {
      // 表单校验规则
      $("#contactForm").validate({
        rules: {
          realname: {
            required: true
          },
          message: {
            required: true
          },
          email: {
            required: true,
            checkEmail: true
          }
        },
        messages: {
          realname: {
            required: "Please enter your name.",
            minlength: "Your name must be at least 2 characters."
          },
          message: {
            required: "Please enter message.",
            minlength: "Your message must be at least 10 characters."
          },
          email: {
            required: "Please enter your email address or phone number.",
            pattern: "Please enter a valid email address or phone number."
          }
        },
        errorPlacement: function (error, element) {
          error.insertAfter(element); // 错误提示显示在输入框下方
        },
        submitHandler: function (form, event) {
          event.preventDefault(); // 阻止默认提交行为
          myFunction(); // 表单验证通过后调用 myFunction
        }
      });

      // 捕获表单的 submit 事件
      $("#contactForm").submit(function (event) {
        event.preventDefault(); // 阻止默认提交行为
      });

      $.validator.addMethod("checkEmail", function (value, element, params) {
        var checkEmail = /^(?:[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}|[0-9]+(?:\.[0-9]+)?)$/;
        return this.optional(element) || (checkEmail.test(value));
      }, "Please enter a valid email address or phone number.");

    });


    function myFunction() {
      try {
        grecaptcha.ready(function () {
          // 设置按钮不可点击
          $("#sent").hide();
          $("#submit").prop("disabled", true);

          // 添加转圈动画
          if (!$("#submit").find(".spinner").length) {
            $("#submit").append('<div class="spinner"></div>');
          }

          grecaptcha.execute("6Lc0jFgrAAAAAIqRdx-gR0yaFs5Nhx8DnvqLzY9R", { action: "submit" }).then(function (token) {
            let data = {
              id: generateGUID(),
              tenant: "www.niobium.co.nz",
              name: $("#realname").val(),
              contact: $("#email").val(),
              message: $("#message").val(),
              token: token
            };
            console.log(data);

            $.ajax({
              url: "https://niobiumnotifyfunc.azurewebsites.net/api/Notification", // 请求的URL
              type: "POST", // 请求类型
              contentType: "application/json", // 指定提交数据的格式为 JSON
              data: JSON.stringify(data),
              success: function (response) {
                console.log("Success:", response);
                $("#sent").show();
                $("#submit").prop("disabled", false);
                $("#submit").find(".spinner").remove();
              },
              error: function (xhr, status, error) {
                console.error("Error:", error);
                $("#submit").prop("disabled", false);
                $("#submit").find(".spinner").remove();
              }
            });

            // $("#sent").show();
            //         $("#submit").prop("disabled", false);
            //         $("#submit").find(".spinner").remove();

          });
        });
      } catch (error) {
        console.error("An unexpected error occurred:", error);
        $("#submit").prop("disabled", false);
        $("#submit").find(".spinner").remove();
      } finally {
        // 无论成功或失败，恢复按钮状态
        $("#submit").prop("disabled", false);
        $("#submit").find(".spinner").remove();
      }
    }

    function generateGUID() {
      return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
        const r = (Math.random() * 16) | 0; // 生成一个0-15的随机数
        const v = c === "x" ? r : (r & 0x3) | 0x8; // 确保第13位是4，第17位是8、9、A或B
        return v.toString(16); // 转换为16进制
      });
    }


  </script>

  <style>
    .sent {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 13px 22px;
      font-size: 20px;
      color: #3c9cff;
    }

    .button {
      display: flex;
    }

    .btn_1:hover:disabled {
      color: #ffffff !important;
    }

    .button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      border: 0px;
    }

    .spinner {
      margin-left: 5px;
      width: 16px;
      height: 16px;
      border: 2px solid transparent;
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>

</body>

</html>